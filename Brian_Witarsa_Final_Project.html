<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Brian_Witarsa_Final_Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Brian_Witarsa_Final_Project_files/libs/clipboard/clipboard.min.js"></script>
<script src="Brian_Witarsa_Final_Project_files/libs/quarto-html/quarto.js"></script>
<script src="Brian_Witarsa_Final_Project_files/libs/quarto-html/popper.min.js"></script>
<script src="Brian_Witarsa_Final_Project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Brian_Witarsa_Final_Project_files/libs/quarto-html/anchor.min.js"></script>
<link href="Brian_Witarsa_Final_Project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Brian_Witarsa_Final_Project_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Brian_Witarsa_Final_Project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Brian_Witarsa_Final_Project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Brian_Witarsa_Final_Project_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Brian_Witarsa_Final_Project</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="part-one" class="level2">
<h2 class="anchored" data-anchor-id="part-one">Part One</h2>
<p>This analysis investigates customer satisfaction in San Francisco International Airport. The report explores the impact of demographic factors on customer satisfaction through factor analysis, and qualitative factors through sentiment analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ ggplot2::%+%()   masks psych::%+%()
✖ ggplot2::alpha() masks psych::alpha()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.

Attaching package: 'lavaan'

The following object is masked from 'package:psych':

    cor2cov</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sentimentr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"SFO_survey_withText.txt"</span>, <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 3234 Columns: 101
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr  (2): DESTINATION, Q7_text_All
dbl (82): TERM, STRATA, ATYPE, AIRLINE, DEST, GATENUM, INTDATE, Q1, Q2_1, Q2...
num  (3): RESPNUM, CCGID, INC
lgl (14): Q2_5, Q2_6, Q3_5, Q3_6, Q8COM2, Q8COM3, Q9ANEG2, Q9ANEG3, Q9ANTR3,...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Q6A"</span>, <span class="st">"Q6B"</span>, <span class="st">"Q6C"</span>, <span class="st">"Q6D"</span>, <span class="st">"Q6E"</span>, <span class="st">"Q6F"</span>, <span class="st">"Q6G"</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Q6H"</span>, <span class="st">"Q6I"</span>, <span class="st">"Q6J"</span>, <span class="st">"Q6K"</span>, <span class="st">"Q6L"</span>, <span class="st">"Q6M"</span>, <span class="st">"Q6N"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data[cols]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,234 × 14
     Q6A   Q6B   Q6C   Q6D   Q6E   Q6F   Q6G   Q6H   Q6I   Q6J   Q6K   Q6L   Q6M
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     5     3     3     4     4     4     6     6     3     6     6     6     6
 2     6     3     3     4     4     6     6     6     4     6     4     6     6
 3     6     6     3     4     3     5     6     6     6     6     6     6     6
 4     3     6     6     3     4     3     6     6     2     6     6     6     6
 5     5     5     5     5     4     5     5     5     5     5     5     5     5
 6     6     6     6     4     5     5     6     6     6     6     5     6     6
 7     3     2     2     3     3     4     3     3     4     3     4     3     6
 8     5     5     5     5     5     5     5     5     5     5     5     5     5
 9     5     5     5     5     5     4     5     5     5     5     5     6     6
10     5     4     4     4     4     4     6     6     4     5     6     6     6
# ℹ 3,224 more rows
# ℹ 1 more variable: Q6N &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(n), <span class="at">size =</span> <span class="fu">floor</span>(<span class="fl">0.7</span> <span class="sc">*</span> n))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> df[idx, ]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>test  <span class="ot">&lt;-</span> df[<span class="sc">-</span>idx, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>n_train <span class="ot">&lt;-</span> <span class="fu">nrow</span>(train)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>n_test <span class="ot">&lt;-</span> <span class="fu">nrow</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: KMO(r = train)
Overall MSA =  0.82
MSA for each item = 
 Q6A  Q6B  Q6C  Q6D  Q6E  Q6F  Q6G  Q6H  Q6I  Q6J  Q6K  Q6L  Q6M  Q6N 
0.93 0.83 0.85 0.85 0.92 0.87 0.70 0.70 0.85 0.76 0.84 0.79 0.80 0.89 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(train, <span class="at">n.obs =</span> n_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in fa.parallel(train, n.obs = n_train): You specified the number of
subjects, implying a correlation matrix, but do not have a correlation matrix,
correlations found</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Brian_Witarsa_Final_Project_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  5  and the number of components =  4 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>efa <span class="ot">&lt;-</span> <span class="fu">fa</span>(train, <span class="at">n.obs =</span> n_train, <span class="at">rotate =</span> <span class="st">"none"</span>, <span class="at">nfactors =</span> <span class="dv">3</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>efa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = train, nfactors = 3, n.obs = n_train, rotate = "none")
Standardized loadings (pattern matrix) based upon correlation matrix
     MR1   MR2   MR3   h2    u2 com
Q6A 0.47 -0.13 -0.02 0.23 0.765 1.2
Q6B 0.51 -0.13  0.12 0.29 0.706 1.3
Q6C 0.53 -0.15  0.09 0.31 0.686 1.2
Q6D 0.53 -0.38  0.19 0.47 0.535 2.1
Q6E 0.62 -0.29  0.14 0.49 0.510 1.5
Q6F 0.55 -0.38  0.17 0.47 0.527 2.0
Q6G 0.68 -0.03 -0.68 0.92 0.082 2.0
Q6H 0.65 -0.07 -0.59 0.77 0.232 2.0
Q6I 0.54  0.34  0.15 0.43 0.575 1.9
Q6J 0.51  0.46  0.08 0.48 0.524 2.0
Q6K 0.52  0.41  0.18 0.47 0.529 2.2
Q6L 0.47  0.51  0.04 0.48 0.516 2.0
Q6M 0.47  0.41  0.15 0.41 0.588 2.2
Q6N 0.56 -0.35  0.28 0.51 0.489 2.2

                       MR1  MR2  MR3
SS loadings           4.18 1.48 1.07
Proportion Var        0.30 0.11 0.08
Cumulative Var        0.30 0.40 0.48
Proportion Explained  0.62 0.22 0.16
Cumulative Proportion 0.62 0.84 1.00

Mean item complexity =  1.8
Test of the hypothesis that 3 factors are sufficient.

df null model =  91  with the objective function =  5.42 with Chi Square =  12224.36
df of  the model are 52  and the objective function was  0.59 

The root mean square of the residuals (RMSR) is  0.05 
The df corrected root mean square of the residuals is  0.07 

The harmonic n.obs is  2137 with the empirical chi square  991.44  with prob &lt;  8.4e-174 
The total n.obs was  2263  with Likelihood Chi Square =  1323.54  with prob &lt;  8.7e-243 

Tucker Lewis Index of factoring reliability =  0.816
RMSEA index =  0.104  and the 90 % confidence intervals are  0.099 0.109
BIC =  921.87
Fit based upon off diagonal values = 0.97
Measures of factor score adequacy             
                                                   MR1  MR2  MR3
Correlation of (regression) scores with factors   0.95 0.86 0.92
Multiple R square of scores with factors          0.90 0.73 0.84
Minimum correlation of possible factor scores     0.81 0.47 0.69</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>efa1 <span class="ot">&lt;-</span> <span class="fu">fa</span>(train, <span class="at">n.obs =</span> n_train, <span class="at">rotate =</span> <span class="st">"none"</span>, <span class="at">nfactors =</span> <span class="dv">4</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>efa1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = train, nfactors = 4, n.obs = n_train, rotate = "none")
Standardized loadings (pattern matrix) based upon correlation matrix
     MR1   MR2   MR3   MR4   h2   u2 com
Q6A 0.47 -0.13 -0.02  0.20 0.28 0.72 1.5
Q6B 0.56 -0.17  0.18  0.53 0.65 0.35 2.4
Q6C 0.56 -0.17  0.11  0.38 0.50 0.50 2.1
Q6D 0.55 -0.39  0.17 -0.30 0.57 0.43 2.7
Q6E 0.62 -0.28  0.11 -0.14 0.49 0.51 1.6
Q6F 0.56 -0.39  0.14 -0.26 0.55 0.45 2.4
Q6G 0.66  0.01 -0.65  0.01 0.86 0.14 2.0
Q6H 0.65 -0.04 -0.64 -0.06 0.83 0.17 2.0
Q6I 0.53  0.34  0.15 -0.06 0.43 0.57 1.9
Q6J 0.51  0.46  0.09 -0.03 0.47 0.53 2.0
Q6K 0.51  0.42  0.18 -0.07 0.48 0.52 2.2
Q6L 0.46  0.52  0.05 -0.06 0.49 0.51 2.0
Q6M 0.47  0.41  0.16 -0.04 0.41 0.59 2.2
Q6N 0.55 -0.34  0.25 -0.09 0.49 0.51 2.2

                       MR1  MR2  MR3  MR4
SS loadings           4.23 1.51 1.08 0.67
Proportion Var        0.30 0.11 0.08 0.05
Cumulative Var        0.30 0.41 0.49 0.54
Proportion Explained  0.57 0.20 0.14 0.09
Cumulative Proportion 0.57 0.77 0.91 1.00

Mean item complexity =  2.1
Test of the hypothesis that 4 factors are sufficient.

df null model =  91  with the objective function =  5.42 with Chi Square =  12224.36
df of  the model are 41  and the objective function was  0.28 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  2137 with the empirical chi square  333.8  with prob &lt;  1.5e-47 
The total n.obs was  2263  with Likelihood Chi Square =  640.9  with prob &lt;  9.7e-109 

Tucker Lewis Index of factoring reliability =  0.89
RMSEA index =  0.08  and the 90 % confidence intervals are  0.075 0.086
BIC =  324.2
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR1  MR2  MR3  MR4
Correlation of (regression) scores with factors   0.95 0.86 0.91 0.78
Multiple R square of scores with factors          0.91 0.75 0.83 0.61
Minimum correlation of possible factor scores     0.82 0.50 0.66 0.23</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>efa2 <span class="ot">&lt;-</span> <span class="fu">fa</span>(train, <span class="at">n.obs =</span> n_train, <span class="at">rotate =</span> <span class="st">"varimax"</span>, <span class="at">nfactors =</span> <span class="dv">4</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>efa2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = train, nfactors = 4, n.obs = n_train, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
     MR2  MR1  MR3  MR4   h2   u2 com
Q6A 0.13 0.22 0.22 0.40 0.28 0.72 2.4
Q6B 0.15 0.19 0.06 0.76 0.65 0.35 1.2
Q6C 0.15 0.25 0.13 0.63 0.50 0.50 1.5
Q6D 0.08 0.74 0.11 0.11 0.57 0.43 1.1
Q6E 0.17 0.61 0.18 0.24 0.49 0.51 1.7
Q6F 0.08 0.71 0.14 0.14 0.55 0.45 1.2
Q6G 0.20 0.15 0.87 0.19 0.86 0.14 1.3
Q6H 0.18 0.22 0.86 0.14 0.83 0.17 1.3
Q6I 0.61 0.18 0.09 0.13 0.43 0.57 1.3
Q6J 0.66 0.05 0.13 0.11 0.47 0.53 1.2
Q6K 0.67 0.13 0.05 0.11 0.48 0.52 1.1
Q6L 0.68 0.00 0.15 0.05 0.49 0.51 1.1
Q6M 0.62 0.09 0.05 0.11 0.41 0.59 1.1
Q6N 0.12 0.63 0.03 0.29 0.49 0.51 1.5

                       MR2  MR1  MR3  MR4
SS loadings           2.30 2.09 1.68 1.42
Proportion Var        0.16 0.15 0.12 0.10
Cumulative Var        0.16 0.31 0.43 0.54
Proportion Explained  0.31 0.28 0.22 0.19
Cumulative Proportion 0.31 0.59 0.81 1.00

Mean item complexity =  1.4
Test of the hypothesis that 4 factors are sufficient.

df null model =  91  with the objective function =  5.42 with Chi Square =  12224.36
df of  the model are 41  and the objective function was  0.28 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  2137 with the empirical chi square  333.8  with prob &lt;  1.5e-47 
The total n.obs was  2263  with Likelihood Chi Square =  640.9  with prob &lt;  9.7e-109 

Tucker Lewis Index of factoring reliability =  0.89
RMSEA index =  0.08  and the 90 % confidence intervals are  0.075 0.086
BIC =  324.2
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR2  MR1  MR3  MR4
Correlation of (regression) scores with factors   0.88 0.87 0.94 0.83
Multiple R square of scores with factors          0.78 0.76 0.88 0.68
Minimum correlation of possible factor scores     0.55 0.52 0.76 0.37</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>efa3 <span class="ot">&lt;-</span> <span class="fu">fa</span>(train, <span class="at">n.obs =</span> n_train, <span class="at">rotate =</span> <span class="st">"promax"</span>, <span class="at">nfactors =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required namespace: GPArotation</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>efa3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = train, nfactors = 4, n.obs = n_train, rotate = "promax")
Standardized loadings (pattern matrix) based upon correlation matrix
      MR2   MR1   MR3   MR4   h2   u2 com
Q6A  0.00  0.07  0.14  0.40 0.28 0.72 1.3
Q6B -0.01 -0.09 -0.09  0.90 0.65 0.35 1.0
Q6C  0.00  0.02  0.00  0.69 0.50 0.50 1.0
Q6D -0.02  0.83  0.00 -0.12 0.57 0.43 1.0
Q6E  0.05  0.60  0.07  0.07 0.49 0.51 1.1
Q6F -0.03  0.78  0.04 -0.08 0.55 0.45 1.0
Q6G  0.01 -0.05  0.93  0.02 0.86 0.14 1.0
Q6H -0.01  0.05  0.92 -0.05 0.83 0.17 1.0
Q6I  0.61  0.10 -0.02  0.02 0.43 0.57 1.1
Q6J  0.68 -0.06  0.05  0.02 0.47 0.53 1.0
Q6K  0.69  0.05 -0.06  0.00 0.48 0.52 1.0
Q6L  0.71 -0.10  0.08 -0.06 0.49 0.51 1.1
Q6M  0.65  0.01 -0.05  0.02 0.41 0.59 1.0
Q6N  0.01  0.63 -0.11  0.16 0.49 0.51 1.2

                       MR2  MR1  MR3  MR4
SS loadings           2.25 2.06 1.74 1.43
Proportion Var        0.16 0.15 0.12 0.10
Cumulative Var        0.16 0.31 0.43 0.54
Proportion Explained  0.30 0.28 0.23 0.19
Cumulative Proportion 0.30 0.58 0.81 1.00

 With factor correlations of 
     MR2  MR1  MR3  MR4
MR2 1.00 0.34 0.39 0.42
MR1 0.34 1.00 0.42 0.61
MR3 0.39 0.42 1.00 0.46
MR4 0.42 0.61 0.46 1.00

Mean item complexity =  1.1
Test of the hypothesis that 4 factors are sufficient.

df null model =  91  with the objective function =  5.42 with Chi Square =  12224.36
df of  the model are 41  and the objective function was  0.28 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  2137 with the empirical chi square  333.8  with prob &lt;  1.5e-47 
The total n.obs was  2263  with Likelihood Chi Square =  640.9  with prob &lt;  9.7e-109 

Tucker Lewis Index of factoring reliability =  0.89
RMSEA index =  0.08  and the 90 % confidence intervals are  0.075 0.086
BIC =  324.2
Fit based upon off diagonal values = 0.99
Measures of factor score adequacy             
                                                   MR2  MR1  MR3  MR4
Correlation of (regression) scores with factors   0.90 0.91 0.96 0.90
Multiple R square of scores with factors          0.82 0.83 0.92 0.80
Minimum correlation of possible factor scores     0.63 0.66 0.84 0.61</code></pre>
</div>
</div>
<p>The fa.parallel function recommended we use 4 factors. Doing the first efa with rotate = “none”, we found that the TLI was &gt; 0.9 and the RMSEA was around 0.07, less than 0.1, but not quite 0.05. I tested other EFAs with factors less than 4, but it produced much lower TLI and higher RMSEA than the 4 factor model.</p>
<p>To compare models, I chose to compare the different rotations (none, orthogonal, oblique). Comparing the mean item complexity for all 3, we can see that none rotation has the highest complexity at 2.1, followed by orthogonal at 1.4, and finally oblique with the least at 1.1.</p>
<p>In the unrotated model, the loading matrix shows many items with cross loadings, thus making interpretation difficult. With varimax rotation, the loadings are cleaner, as each factor is defined by several items with strong primary loadings and reduced overlap. With promax rotation, the loading matrix shows the simplest structure, with clear item–factor groupings.</p>
<p>Factor Correlations for Oblique rotation:</p>
<pre><code> MR2  MR1  MR3  MR4</code></pre>
<p>MR2 1.00 0.37 0.42 0.45 MR1 0.37 1.00 0.43 0.62 MR3 0.42 0.43 1.00 0.47 MR4 0.45 0.62 0.47 1.00</p>
</section>
<section id="part-two" class="level2">
<h2 class="anchored" data-anchor-id="part-two">Part Two</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>confirm_3Fac <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="st">F1 =~ Q6A + Q6B + Q6C + Q6D + Q6E + Q6F + Q6I + Q6N</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="st">F2 =~ Q6J + Q6K + Q6L + Q6M</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="st">F3 =~ Q6G + Q6H</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>fit_3Fac <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(confirm_3Fac, <span class="at">data=</span>test, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_3Fac, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 25 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        31

                                                  Used       Total
  Number of observations                           815         971

Model Test User Model:
                                                      
  Test statistic                               717.946
  Degrees of freedom                                74
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              4572.310
  Degrees of freedom                                91
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.856
  Tucker-Lewis Index (TLI)                       0.823

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -15348.522
  Loglikelihood unrestricted model (H1)     -14989.549
                                                      
  Akaike (AIC)                               30759.043
  Bayesian (BIC)                             30904.842
  Sample-size adjusted Bayesian (SABIC)      30806.398

Root Mean Square Error of Approximation:

  RMSEA                                          0.103
  90 Percent confidence interval - lower         0.097
  90 Percent confidence interval - upper         0.110
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.080

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  F1 =~                                                                 
    Q6A               0.500    0.043   11.670    0.000    0.500    0.423
    Q6B               0.660    0.044   15.033    0.000    0.660    0.528
    Q6C               0.747    0.044   16.872    0.000    0.747    0.582
    Q6D               0.584    0.030   19.362    0.000    0.584    0.650
    Q6E               0.673    0.031   21.702    0.000    0.673    0.710
    Q6F               0.660    0.032   20.645    0.000    0.660    0.683
    Q6I               0.580    0.044   13.273    0.000    0.580    0.474
    Q6N               0.519    0.024   22.021    0.000    0.519    0.718
  F2 =~                                                                 
    Q6J               0.823    0.042   19.553    0.000    0.823    0.686
    Q6K               0.732    0.038   19.065    0.000    0.732    0.671
    Q6L               0.681    0.035   19.276    0.000    0.681    0.678
    Q6M               0.791    0.044   18.082    0.000    0.791    0.642
  F3 =~                                                                 
    Q6G               1.255    0.040   31.398    0.000    1.255    0.963
    Q6H               1.163    0.041   28.662    0.000    1.163    0.896

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  F1 ~~                                                                 
    F2                0.500    0.035   14.143    0.000    0.500    0.500
    F3                0.498    0.031   15.951    0.000    0.498    0.498
  F2 ~~                                                                 
    F3                0.426    0.035   12.078    0.000    0.426    0.426

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Q6A               1.149    0.059   19.393    0.000    1.149    0.821
   .Q6B               1.127    0.060   18.770    0.000    1.127    0.721
   .Q6C               1.090    0.060   18.308    0.000    1.090    0.661
   .Q6D               0.466    0.027   17.491    0.000    0.466    0.577
   .Q6E               0.446    0.027   16.438    0.000    0.446    0.496
   .Q6F               0.497    0.029   16.955    0.000    0.497    0.533
   .Q6I               1.159    0.061   19.127    0.000    1.159    0.775
   .Q6N               0.254    0.016   16.266    0.000    0.254    0.485
   .Q6J               0.764    0.051   15.065    0.000    0.764    0.530
   .Q6K               0.653    0.042   15.456    0.000    0.653    0.549
   .Q6L               0.547    0.036   15.291    0.000    0.547    0.541
   .Q6M               0.890    0.055   16.152    0.000    0.890    0.587
   .Q6G               0.125    0.055    2.258    0.024    0.125    0.073
   .Q6H               0.331    0.050    6.627    0.000    0.331    0.196
    F1                1.000                               1.000    1.000
    F2                1.000                               1.000    1.000
    F3                1.000                               1.000    1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit_3Fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Brian_Witarsa_Final_Project_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>confirm_4Fac <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="st">F1 =~ Q6D + Q6E + Q6F + Q6N</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="st">F2 =~ Q6I + Q6J + Q6K + Q6L + Q6M</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="st">F3 =~ Q6G + Q6H</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="st">F4 =~ Q6A + Q6B + Q6C</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>fit_4Fac <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(confirm_4Fac, <span class="at">data=</span>test, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_4Fac, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 25 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        34

                                                  Used       Total
  Number of observations                           815         971

Model Test User Model:
                                                      
  Test statistic                               311.556
  Degrees of freedom                                71
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              4572.310
  Degrees of freedom                                91
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.946
  Tucker-Lewis Index (TLI)                       0.931

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -15145.327
  Loglikelihood unrestricted model (H1)     -14989.549
                                                      
  Akaike (AIC)                               30358.653
  Bayesian (BIC)                             30518.561
  Sample-size adjusted Bayesian (SABIC)      30410.591

Root Mean Square Error of Approximation:

  RMSEA                                          0.064
  90 Percent confidence interval - lower         0.057
  90 Percent confidence interval - upper         0.072
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.044

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  F1 =~                                                                 
    Q6D               0.631    0.030   21.128    0.000    0.631    0.703
    Q6E               0.694    0.031   22.275    0.000    0.694    0.732
    Q6F               0.694    0.032   21.741    0.000    0.694    0.718
    Q6N               0.532    0.024   22.462    0.000    0.532    0.736
  F2 =~                                                                 
    Q6I               0.840    0.041   20.277    0.000    0.840    0.686
    Q6J               0.867    0.040   21.633    0.000    0.867    0.722
    Q6K               0.708    0.037   18.911    0.000    0.708    0.650
    Q6L               0.656    0.034   19.002    0.000    0.656    0.652
    Q6M               0.775    0.043   18.188    0.000    0.775    0.629
  F3 =~                                                                 
    Q6G               1.255    0.040   31.362    0.000    1.255    0.963
    Q6H               1.163    0.041   28.636    0.000    1.163    0.896
  F4 =~                                                                 
    Q6A               0.543    0.045   12.142    0.000    0.543    0.459
    Q6B               0.878    0.045   19.550    0.000    0.878    0.702
    Q6C               0.983    0.046   21.401    0.000    0.983    0.766

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  F1 ~~                                                                 
    F2                0.416    0.037   11.107    0.000    0.416    0.416
    F3                0.443    0.033   13.225    0.000    0.443    0.443
    F4                0.636    0.033   19.464    0.000    0.636    0.636
  F2 ~~                                                                 
    F3                0.435    0.034   12.803    0.000    0.435    0.435
    F4                0.510    0.037   13.624    0.000    0.510    0.510
  F3 ~~                                                                 
    F4                0.429    0.036   11.767    0.000    0.429    0.429

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Q6D               0.408    0.025   16.108    0.000    0.408    0.506
   .Q6E               0.418    0.027   15.350    0.000    0.418    0.465
   .Q6F               0.452    0.029   15.721    0.000    0.452    0.484
   .Q6N               0.239    0.016   15.213    0.000    0.239    0.458
   .Q6I               0.791    0.049   16.098    0.000    0.791    0.529
   .Q6J               0.690    0.045   15.183    0.000    0.690    0.479
   .Q6K               0.688    0.041   16.851    0.000    0.688    0.578
   .Q6L               0.581    0.035   16.805    0.000    0.581    0.575
   .Q6M               0.915    0.053   17.192    0.000    0.915    0.604
   .Q6G               0.125    0.055    2.251    0.024    0.125    0.073
   .Q6H               0.331    0.050    6.604    0.000    0.331    0.196
   .Q6A               1.104    0.059   18.566    0.000    1.104    0.789
   .Q6B               0.792    0.057   13.787    0.000    0.792    0.507
   .Q6C               0.681    0.061   11.081    0.000    0.681    0.413
    F1                1.000                               1.000    1.000
    F2                1.000                               1.000    1.000
    F3                1.000                               1.000    1.000
    F4                1.000                               1.000    1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit_4Fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Brian_Witarsa_Final_Project_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The 4 factor CFA had higher CLI and TLI than the results from the 3 factor CFA. It also had a lower RMSEA, with the 3 factor model producing an RMSEA of 0.114, over the 0.1 threshold for a decent fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(fit_4Fac, <span class="at">sort=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lhs op rhs     mi    epc sepc.lv sepc.all sepc.nox
145 Q6K ~~ Q6M 83.758  0.320   0.320    0.403    0.403
137 Q6J ~~ Q6L 78.406  0.277   0.277    0.438    0.438
138 Q6J ~~ Q6M 54.462 -0.283  -0.283   -0.355   -0.355
129 Q6I ~~ Q6L 24.648 -0.158  -0.158   -0.233   -0.233
39   F1 =~ Q6I 23.880  0.221   0.221    0.180    0.180
67   F3 =~ Q6A 17.607  0.196   0.196    0.165    0.165
70   F4 =~ Q6D 16.428 -0.184  -0.184   -0.205   -0.205
136 Q6J ~~ Q6K 16.189 -0.137  -0.137   -0.198   -0.198
171 Q6B ~~ Q6C 13.328  0.311   0.311    0.424    0.424
40   F1 =~ Q6J 12.913 -0.157  -0.157   -0.131   -0.131
73   F4 =~ Q6N 11.625  0.124   0.124    0.171    0.171
127 Q6I ~~ Q6J 11.515  0.130   0.130    0.176    0.176
46   F1 =~ Q6A  9.427  0.204   0.204    0.173    0.173
121 Q6N ~~ Q6M  9.285  0.060   0.060    0.127    0.127
95  Q6E ~~ Q6N  8.304 -0.051  -0.051   -0.160   -0.160
84  Q6D ~~ Q6I  7.997  0.067   0.067    0.119    0.119
154 Q6L ~~ Q6A  7.726  0.087   0.087    0.108    0.108
42   F1 =~ Q6L  7.525 -0.103  -0.103   -0.103   -0.103
170 Q6A ~~ Q6C  6.879 -0.126  -0.126   -0.146   -0.146
81  Q6D ~~ Q6E  6.859  0.056   0.056    0.136    0.136
87  Q6D ~~ Q6L  6.598 -0.052  -0.052   -0.106   -0.106
118 Q6N ~~ Q6J  6.247 -0.045  -0.045   -0.110   -0.110
50   F2 =~ Q6E  6.137  0.085   0.085    0.089    0.089
68   F3 =~ Q6B  5.599 -0.119  -0.119   -0.095   -0.095
74   F4 =~ Q6I  5.490  0.122   0.122    0.099    0.099
125 Q6N ~~ Q6B  5.216  0.045   0.045    0.104    0.104
49   F2 =~ Q6D  5.191 -0.075  -0.075   -0.083   -0.083
167 Q6H ~~ Q6B  4.815 -0.051  -0.051   -0.100   -0.100
144 Q6K ~~ Q6L  4.218 -0.058  -0.058   -0.092   -0.092
151 Q6L ~~ Q6M  3.772 -0.063  -0.063   -0.086   -0.086
124 Q6N ~~ Q6A  3.626  0.040   0.040    0.077    0.077
47   F1 =~ Q6B  3.434 -0.154  -0.154   -0.123   -0.123
165 Q6G ~~ Q6C  3.300 -0.043  -0.043   -0.147   -0.147
58   F3 =~ Q6D  3.219 -0.055  -0.055   -0.061   -0.061
101 Q6E ~~ Q6G  3.208  0.030   0.030    0.130    0.130
168 Q6H ~~ Q6C  3.166  0.042   0.042    0.088    0.088
120 Q6N ~~ Q6L  3.153 -0.028  -0.028   -0.075   -0.075
59   F3 =~ Q6E  3.118  0.056   0.056    0.059    0.059
148 Q6K ~~ Q6A  2.806 -0.057  -0.057   -0.065   -0.065
93  Q6D ~~ Q6C  2.683 -0.041  -0.041   -0.078   -0.078
107 Q6F ~~ Q6I  2.549  0.040   0.040    0.068    0.068
66   F3 =~ Q6M  2.376  0.067   0.067    0.055    0.055
63   F3 =~ Q6J  2.275 -0.062  -0.062   -0.051   -0.051
54   F2 =~ Q6H  2.209 -0.071  -0.071   -0.055   -0.055
53   F2 =~ Q6G  2.209  0.077   0.077    0.059    0.059
94  Q6E ~~ Q6F  2.184 -0.034  -0.034   -0.079   -0.079
64   F3 =~ Q6K  2.124 -0.056  -0.056   -0.051   -0.051
76   F4 =~ Q6K  2.117 -0.068  -0.068   -0.063   -0.063
152 Q6L ~~ Q6G  2.071  0.027   0.027    0.100    0.100
91  Q6D ~~ Q6A  2.033 -0.038  -0.038   -0.057   -0.057
99  Q6E ~~ Q6L  1.972  0.029   0.029    0.059    0.059
71   F4 =~ Q6E  1.868  0.065   0.065    0.069    0.069
44   F1 =~ Q6G  1.863 -0.075  -0.075   -0.057   -0.057
45   F1 =~ Q6H  1.863  0.069   0.069    0.053    0.053
104 Q6E ~~ Q6B  1.845 -0.035  -0.035   -0.061   -0.061
89  Q6D ~~ Q6G  1.750 -0.021  -0.021   -0.094   -0.094
142 Q6J ~~ Q6B  1.747  0.044   0.044    0.059    0.059
109 Q6F ~~ Q6K  1.737  0.031   0.031    0.055    0.055
108 Q6F ~~ Q6J  1.730 -0.032  -0.032   -0.057   -0.057
102 Q6E ~~ Q6H  1.692 -0.022  -0.022   -0.058   -0.058
85  Q6D ~~ Q6J  1.572 -0.029  -0.029   -0.054   -0.054
147 Q6K ~~ Q6H  1.523 -0.025  -0.025   -0.053   -0.053
163 Q6G ~~ Q6A  1.503  0.030   0.030    0.081    0.081
113 Q6F ~~ Q6H  1.495  0.021   0.021    0.054    0.054
143 Q6J ~~ Q6C  1.434  0.040   0.040    0.058    0.058
77   F4 =~ Q6L  1.324 -0.050  -0.050   -0.050   -0.050
111 Q6F ~~ Q6M  1.317 -0.030  -0.030   -0.047   -0.047
133 Q6I ~~ Q6A  1.281 -0.042  -0.042   -0.045   -0.045
128 Q6I ~~ Q6K  1.082 -0.036  -0.036   -0.049   -0.049
164 Q6G ~~ Q6B  0.998  0.023   0.023    0.074    0.074
62   F3 =~ Q6I  0.997  0.042   0.042    0.035    0.035
106 Q6F ~~ Q6N  0.993  0.018   0.018    0.054    0.054
159 Q6M ~~ Q6A  0.968 -0.038  -0.038   -0.038   -0.038
115 Q6F ~~ Q6B  0.915 -0.026  -0.026   -0.043   -0.043
72   F4 =~ Q6F  0.915 -0.046  -0.046   -0.048   -0.048
105 Q6E ~~ Q6C  0.909  0.025   0.025    0.047    0.047
92  Q6D ~~ Q6B  0.904 -0.024  -0.024   -0.042   -0.042
150 Q6K ~~ Q6C  0.843 -0.029  -0.029   -0.042   -0.042
90  Q6D ~~ Q6H  0.807  0.015   0.015    0.039    0.039
166 Q6H ~~ Q6A  0.802  0.022   0.022    0.037    0.037
82  Q6D ~~ Q6F  0.799  0.019   0.019    0.045    0.045
103 Q6E ~~ Q6A  0.782  0.024   0.024    0.036    0.036
43   F1 =~ Q6M  0.758  0.041   0.041    0.033    0.033
122 Q6N ~~ Q6G  0.707 -0.011  -0.011   -0.061   -0.061
126 Q6N ~~ Q6C  0.673  0.016   0.016    0.040    0.040
55   F2 =~ Q6A  0.641  0.044   0.044    0.037    0.037
41   F1 =~ Q6K  0.620  0.032   0.032    0.030    0.030
139 Q6J ~~ Q6G  0.613 -0.017  -0.017   -0.057   -0.057
88  Q6D ~~ Q6M  0.585 -0.019  -0.019   -0.031   -0.031
169 Q6A ~~ Q6B  0.550 -0.033  -0.033   -0.035   -0.035
61   F3 =~ Q6N  0.544 -0.018  -0.018   -0.025   -0.025
156 Q6L ~~ Q6C  0.542 -0.021  -0.021   -0.034   -0.034
100 Q6E ~~ Q6M  0.527 -0.019  -0.019   -0.030   -0.030
60   F3 =~ Q6F  0.484  0.023   0.023    0.024    0.024
153 Q6L ~~ Q6H  0.458 -0.013  -0.013   -0.029   -0.029
86  Q6D ~~ Q6K  0.419  0.014   0.014    0.027    0.027
112 Q6F ~~ Q6G  0.418 -0.011  -0.011   -0.046   -0.046
65   F3 =~ Q6L  0.396  0.022   0.022    0.022    0.022
97  Q6E ~~ Q6J  0.337  0.014   0.014    0.025    0.025
79   F4 =~ Q6G  0.336 -0.034  -0.034   -0.026   -0.026
80   F4 =~ Q6H  0.336  0.031   0.031    0.024    0.024
110 Q6F ~~ Q6L  0.313 -0.012  -0.012   -0.023   -0.023
132 Q6I ~~ Q6H  0.312 -0.013  -0.013   -0.025   -0.025
149 Q6K ~~ Q6B  0.306 -0.018  -0.018   -0.024   -0.024
114 Q6F ~~ Q6A  0.295  0.015   0.015    0.022    0.022
116 Q6F ~~ Q6C  0.265 -0.014  -0.014   -0.025   -0.025
48   F1 =~ Q6C  0.262 -0.047  -0.047   -0.037   -0.037
117 Q6N ~~ Q6I  0.209  0.009   0.009    0.020    0.020
158 Q6M ~~ Q6H  0.195  0.010   0.010    0.019    0.019
96  Q6E ~~ Q6I  0.195  0.011   0.011    0.019    0.019
140 Q6J ~~ Q6H  0.194  0.009   0.009    0.020    0.020
78   F4 =~ Q6M  0.179  0.023   0.023    0.018    0.018
69   F3 =~ Q6C  0.176 -0.023  -0.023   -0.018   -0.018
98  Q6E ~~ Q6K  0.158  0.009   0.009    0.017    0.017
56   F2 =~ Q6B  0.133 -0.022  -0.022   -0.018   -0.018
157 Q6M ~~ Q6G  0.129  0.008   0.008    0.025    0.025
155 Q6L ~~ Q6B  0.127 -0.010  -0.010   -0.015   -0.015
161 Q6M ~~ Q6C  0.103  0.012   0.012    0.015    0.015
131 Q6I ~~ Q6G  0.082  0.006   0.006    0.020    0.020
123 Q6N ~~ Q6H  0.077  0.004   0.004    0.012    0.012
75   F4 =~ Q6J  0.073 -0.014  -0.014   -0.011   -0.011
146 Q6K ~~ Q6G  0.070  0.005   0.005    0.018    0.018
141 Q6J ~~ Q6A  0.039  0.007   0.007    0.008    0.008
119 Q6N ~~ Q6K  0.037  0.003   0.003    0.008    0.008
57   F2 =~ Q6C  0.033 -0.012  -0.012   -0.010   -0.010
51   F2 =~ Q6F  0.028 -0.006  -0.006   -0.006   -0.006
160 Q6M ~~ Q6B  0.025 -0.006  -0.006   -0.007   -0.007
52   F2 =~ Q6N  0.023 -0.004  -0.004   -0.005   -0.005
130 Q6I ~~ Q6M  0.009  0.004   0.004    0.004    0.004
135 Q6I ~~ Q6C  0.004 -0.002  -0.002   -0.003   -0.003
83  Q6D ~~ Q6N  0.002 -0.001  -0.001   -0.002   -0.002
134 Q6I ~~ Q6B  0.000  0.001   0.001    0.001    0.001</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>confirm_4Fac <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="st">F1 =~ Q6D + Q6E + Q6F + Q6N</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="st">F2 =~ Q6I + Q6J + Q6K + Q6L + Q6M</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="st">F3 =~ Q6G + Q6H</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="st">F4 =~ Q6A + Q6B + Q6C</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="st">Q6K ~~ Q6M</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>fit_4Fac <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(confirm_4Fac, <span class="at">data=</span>test, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_4Fac, <span class="at">fit.measures =</span> T, <span class="at">standardized =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 26 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        35

                                                  Used       Total
  Number of observations                           815         971

Model Test User Model:
                                                      
  Test statistic                               229.437
  Degrees of freedom                                70
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              4572.310
  Degrees of freedom                                91
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.964
  Tucker-Lewis Index (TLI)                       0.954

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -15104.267
  Loglikelihood unrestricted model (H1)     -14989.549
                                                      
  Akaike (AIC)                               30278.535
  Bayesian (BIC)                             30443.146
  Sample-size adjusted Bayesian (SABIC)      30332.000

Root Mean Square Error of Approximation:

  RMSEA                                          0.053
  90 Percent confidence interval - lower         0.045
  90 Percent confidence interval - upper         0.061
  P-value H_0: RMSEA &lt;= 0.050                    0.257
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.043

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  F1 =~                                                                 
    Q6D               0.631    0.030   21.134    0.000    0.631    0.703
    Q6E               0.694    0.031   22.263    0.000    0.694    0.732
    Q6F               0.694    0.032   21.741    0.000    0.694    0.718
    Q6N               0.532    0.024   22.449    0.000    0.532    0.736
  F2 =~                                                                 
    Q6I               0.837    0.042   19.991    0.000    0.837    0.684
    Q6J               0.927    0.040   23.237    0.000    0.927    0.772
    Q6K               0.629    0.039   16.160    0.000    0.629    0.577
    Q6L               0.680    0.034   19.703    0.000    0.680    0.676
    Q6M               0.676    0.044   15.206    0.000    0.676    0.549
  F3 =~                                                                 
    Q6G               1.254    0.040   31.289    0.000    1.254    0.962
    Q6H               1.164    0.041   28.650    0.000    1.164    0.897
  F4 =~                                                                 
    Q6A               0.544    0.045   12.185    0.000    0.544    0.460
    Q6B               0.878    0.045   19.570    0.000    0.878    0.702
    Q6C               0.982    0.046   21.409    0.000    0.982    0.765

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .Q6K ~~                                                                
   .Q6M               0.326    0.040    8.206    0.000    0.326    0.355
  F1 ~~                                                                 
    F2                0.396    0.038   10.363    0.000    0.396    0.396
    F3                0.443    0.033   13.234    0.000    0.443    0.443
    F4                0.636    0.033   19.469    0.000    0.636    0.636
  F2 ~~                                                                 
    F3                0.428    0.034   12.461    0.000    0.428    0.428
    F4                0.512    0.038   13.595    0.000    0.512    0.512
  F3 ~~                                                                 
    F4                0.429    0.036   11.779    0.000    0.429    0.429

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Q6D               0.408    0.025   16.093    0.000    0.408    0.506
   .Q6E               0.418    0.027   15.345    0.000    0.418    0.465
   .Q6F               0.452    0.029   15.708    0.000    0.452    0.484
   .Q6N               0.239    0.016   15.208    0.000    0.239    0.458
   .Q6I               0.796    0.050   15.845    0.000    0.796    0.532
   .Q6J               0.583    0.045   12.922    0.000    0.583    0.404
   .Q6K               0.793    0.045   17.650    0.000    0.793    0.667
   .Q6L               0.549    0.034   16.038    0.000    0.549    0.543
   .Q6M               1.059    0.059   17.965    0.000    1.059    0.699
   .Q6G               0.128    0.056    2.307    0.021    0.128    0.075
   .Q6H               0.328    0.050    6.523    0.000    0.328    0.195
   .Q6A               1.103    0.059   18.558    0.000    1.103    0.788
   .Q6B               0.793    0.057   13.822    0.000    0.793    0.507
   .Q6C               0.683    0.061   11.153    0.000    0.683    0.414
    F1                1.000                               1.000    1.000
    F2                1.000                               1.000    1.000
    F3                1.000                               1.000    1.000
    F4                1.000                               1.000    1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit_4Fac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Brian_Witarsa_Final_Project_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-three" class="level2">
<h2 class="anchored" data-anchor-id="part-three">Part Three</h2>
<p>Factors:</p>
<p>F1: Terminal Navigation and Wayfinding</p>
<p>F2: Parking, Transit, and Access</p>
<p>F3: Information and Customer Assistance</p>
<p>F4: Amenities and Concessions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lavPredict</span>(fit_4Fac, <span class="at">method =</span> <span class="st">"regression"</span>))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>used_idx <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit_4Fac, <span class="st">"case.idx"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>dems_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Q17"</span>,<span class="st">"Q18"</span>,<span class="st">"COUNTRY"</span>,<span class="st">"Q19"</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>dem_test  <span class="ot">&lt;-</span> data[<span class="sc">-</span>idx, dems_cols]</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>dem_used  <span class="ot">&lt;-</span> dem_test[used_idx, , drop <span class="ot">=</span> <span class="cn">FALSE</span>] </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>dem_scores <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(fs, dem_used)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="effect-of-household-income-on-amenities-and-concessions-f4-rating" class="level2">
<h2 class="anchored" data-anchor-id="effect-of-household-income-on-amenities-and-concessions-f4-rating">Effect of Household income on Amenities and Concessions (F4) rating</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>inference1 <span class="ot">&lt;-</span> dem_scores <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Q19 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="fu">factor</span>(Q19,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Under_50K"</span>,<span class="st">"50_100K"</span>,<span class="st">"100_150K"</span>,<span class="st">"Over_150K"</span>,<span class="st">"Other"</span>)))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>anova_F4 <span class="ot">&lt;-</span> <span class="fu">aov</span>(F4 <span class="sc">~</span> Income, <span class="at">data =</span> inference1)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_F4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
Income        3   17.9   5.969   8.082 2.7e-05 ***
Residuals   670  494.8   0.739                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Null Hypothesis: There is no difference in mean Amenities and Concessions (F4) scores across household income groups.</p>
<p>Alternate Hypothesis: At least one income group’s mean F4 score differs from the others.</p>
<p>Since p = 0.000335, it is &lt; 0.05, and therefore we reject the null hypothesis. Household income has a statistically significant impact on their Amenities and Concessions (F4) scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>lm_F4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(F4 <span class="sc">~</span> Income, <span class="at">data =</span> inference1)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_F4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = F4 ~ Income, data = inference1)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.4874 -0.6295 -0.0955  0.6812  1.9257 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      0.22516    0.06611   3.406 0.000699 ***
Income50_100K   -0.21442    0.09087  -2.360 0.018581 *  
Income100_150K  -0.29961    0.09710  -3.086 0.002116 ** 
IncomeOver_150K -0.45111    0.09349  -4.825 1.73e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8594 on 670 degrees of freedom
Multiple R-squared:  0.03493,   Adjusted R-squared:  0.0306 
F-statistic: 8.082 on 3 and 670 DF,  p-value: 2.702e-05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(inference1, <span class="fu">aes</span>(<span class="at">x=</span>Income, <span class="at">y=</span>F4, <span class="at">fill=</span>Income)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Brian_Witarsa_Final_Project_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Linear Regression confirms that least 2 income groups differ on F4, with the under 50k group scoring higher for F4 than other groups, especially the over 150k bracket.</p>
</section>
<section id="effect-of-gender-and-age-on-parking-transit-and-access-f4-rating" class="level2">
<h2 class="anchored" data-anchor-id="effect-of-gender-and-age-on-parking-transit-and-access-f4-rating">Effect of Gender and Age on Parking, Transit, and Access (F4) rating</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>inference2 <span class="ot">&lt;-</span> dem_scores <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Q17 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, Q18 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age    =</span> <span class="fu">as.numeric</span>(Q17),  </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Gender =</span> <span class="fu">factor</span>(Q18, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>)))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>mod_F1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(F1 <span class="sc">~</span> Age <span class="sc">+</span> Gender, <span class="at">data =</span> inference2)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_F1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = F1 ~ Age + Gender, data = inference2)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.97099 -0.53940 -0.00342  0.68450  2.75288 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  -0.25371    0.10444  -2.429   0.0154 *
Age           0.04567    0.02168   2.106   0.0355 *
GenderFemale  0.12605    0.06550   1.925   0.0547 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9117 on 776 degrees of freedom
Multiple R-squared:  0.01018,   Adjusted R-squared:  0.007625 
F-statistic: 3.989 on 2 and 776 DF,  p-value: 0.0189</code></pre>
</div>
</div>
<section id="age" class="level3">
<h3 class="anchored" data-anchor-id="age">Age</h3>
<p>Null Hypothesis: Age has no effect on F1 Alternative Hypothesis: Age has a significant effect on F1</p>
</section>
<section id="gender" class="level3">
<h3 class="anchored" data-anchor-id="gender">Gender</h3>
<p>Null Hypothesis: There is no difference in mean F1 scores between males and females Alternative Hypothesis: There is a significant difference in mean F1 scores between males and females</p>
<p>The Gender effect was statistically significant (p = 0.001). Female passengers reported higher satisfaction with terminal navigation and information systems than males.</p>
<p>The Age effect was marginal (p = 0.08). It suggests that older travelers may rate navigation better, but since p &gt; 0.05, it is not statistically significant.</p>
<p>So overall, female passengers tend to rate the airport’s signage and navigation systems more positively than males. There is a non-significant tendency for older passengers to do the same.</p>
</section>
</section>
<section id="part-four" class="level2">
<h2 class="anchored" data-anchor-id="part-four">Part Four</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>free_response <span class="ot">&lt;-</span> data[<span class="st">"Q7_text_All"</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>free_response</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,234 × 1
   Q7_text_All                                                                  
   &lt;chr&gt;                                                                        
 1 " Airport Layout-Terminals too far away/confusing/too difficult/takes too lo…
 2 " Food too expensive  Positive comment about wifi  Security/Customs lines/pr…
 3 " Signage outside airport confusing/hard to get to airport/difficult to find…
 4 " Security/Customs lines/procedures long/inefficient/ineffective  Signage in…
 5 " Security/Customs lines/procedures long/inefficient/ineffective"            
 6  &lt;NA&gt;                                                                        
 7 " General cleanliness neg comment  Need more artwork/exhibitions/change artw…
 8  &lt;NA&gt;                                                                        
 9  &lt;NA&gt;                                                                        
10 " Wifi-not free long enough/difficult to access/doesn’t cover entire airport…
# ℹ 3,224 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fr <span class="ot">&lt;-</span> <span class="fu">get_sentences</span>(free_response)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>sentiment_scores <span class="ot">&lt;-</span> <span class="fu">sentiment_by</span>(fr)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>sentiment_scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;element_id&gt;
      element_id word_count        sd ave_sentiment
           &lt;int&gt;      &lt;int&gt;     &lt;num&gt;         &lt;num&gt;
   1:          1         49 0.4626456    -0.3570314
   2:          2         14        NA    -0.1603567
   3:          3         14        NA    -0.2405351
   4:          4         18        NA    -0.5303301
   5:          5          7        NA    -0.5669467
  ---                                              
3230:       3230          0        NA     0.0000000
3231:       3231         19        NA     0.1835326
3232:       3232          0        NA     0.0000000
3233:       3233          0        NA     0.0000000
3234:       3234         10        NA    -1.2807225</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>sentiment_demo <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Q17, Q18, Q19) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">element_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sentiment_scores, <span class="at">by =</span> <span class="st">"element_id"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>sent_by_income <span class="ot">&lt;-</span> sentiment_demo <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Q19 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="fu">factor</span>(Q19,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Under_50K"</span>, <span class="st">"50_100K"</span>, <span class="st">"100_150K"</span>, <span class="st">"Over_150K"</span>, <span class="st">"Other"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Income) <span class="sc">%&gt;%</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_sent =</span> <span class="fu">mean</span>(ave_sentiment, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_sent =</span> <span class="fu">sd</span>(ave_sentiment, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sent_by_income, <span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">y =</span> mean_sent)) <span class="sc">+</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Brian_Witarsa_Final_Project_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Our sentiment analysis clearly shows the mean sentiment scores decreasing as income increases. This could be due to several factors, namely that those earning more tend to have a higher standard of living compared to lower income brackets. This may cause them to be unhappy with the airport experience. Those with higher income brackets may also tend to fly more often, and may have more negative experiences as a result.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In summary, this study provides a comprehensive look at passenger satisfaction at SFO: 1. Four key satisfaction dimensions were identified</p>
<p>F1: Terminal Navigation and Wayfinding</p>
<p>F2: Parking, Transit, and Access</p>
<p>F3: Information and Customer Assistance</p>
<p>F4: Amenities and Concessions</p>
<ol start="2" type="1">
<li><p>Demographic differences exist: lower-income passengers reported more positive experiences, while higher-income travelers were more critical.</p></li>
<li><p>Qualitative feedback aligns with survey findings. Passengers in lower income brackets were generally more positive than their higher income counterparts.</p></li>
</ol>
</section>
<section id="recommendations" class="level2">
<h2 class="anchored" data-anchor-id="recommendations">Recommendations</h2>
<ol type="1">
<li><p>Tailor Communication for different income groups. Higher income customers may value a faster, more convenient experience while lower income customers may value the airport’s ammenities more.</p></li>
<li><p>Enhance Parking, Transit, and Access.</p></li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>